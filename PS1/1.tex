\begin{solution}{Question 1: Lossy Encryption}\label{ques:1}
    \begin{question}
    Show that if $\calE = (\setup, \lsetup, \enc, \dec)$ is a lossy encryption scheme
satisfying all the above properties, then $\calE' = (\setup', \enc', \dec')$ is also a correct
and semantically secure public key encryption scheme.
    \end{question}
    \tcblower{}
%Q1 solution:
%assuming that adversary makes t queries, we make 3 * t + 1 hybrids
%hybrid 0 is encrypting all m_0 using Setup pk
%hybrid i is encryption first i m_0 using Lossy-Setup pk, remaining using Setup pk
%hybrid t+1 to 2t is encrypting last i queries using m_1 instead of m_0 all using Lossy-Setup pk
%hybrid 2t+1 to 3t is encrypting m_1 and the last i queries using Setup pk instead of Lossy-Setup pk
    \begin{proof}
    \textbf{To Prove:} $\calE'$ is a correct and semanticaly secure PKE given $\calE$ as described in the problem statement.\\
    \textbf{Correctness}\\
    For correctness, $\dec'(\enc'(m, pk), sk) = m$\\
    By the definition of $\calE'$, $\setup' = \setup$, $\dec' = \dec$, $\enc' = \enc$. In $\calE'$, all the keys are a $(pk,sk)$ pair generated by $\setup$, which is non-lossy hence the encrypted text can always be decrypted (correctness of $\calE$).\\
    $\dec'(\enc'(m, pk), sk) = \dec(\enc(m,pk))=m$\\
    Therefore the public key encryption scheme $\calE'$ has the correctness property.\\
    \newline
    \textbf{Semantic Security of PKE}\\
    Proof for semantic security of PKE $\calE'$ by hybrid world model.
    \begin{itemize}
        \item \textbf{World 0}: $m_0$ is encrypted using $\setup$
        \begin{enumerate}
            \item Challenger creates a public key $pk$ and a secret key $sk$ using $\setup$
            \item Challenger sends $pk$ to the adversary
            \item The adversary sends two messages $m_0, m_1$ to the challenger
            \item The challenger encrypts $m_0$ using $pk$ and sends it to the adversary
        \end{enumerate}
        
        \item \textbf{Hybrid 0}: $m_0$ is encrypted using $\lsetup$
        \begin{enumerate}
            \item Challenger creates a public key $pk$ using $\lsetup$
            \item Challenger sends $pk$ to the adversary
            \item The adversary sends two messages $m_0, m_1$ to the challenger
            \item The challenger encrypts $m_0$ using $pk$ and sends it to the adversary
        \end{enumerate}
        
        \item \textbf{Hybrid 1}: $m_1$ is encrypted using $\lsetup$
        \begin{enumerate}
            \item Challenger creates a public key $pk$ using $\lsetup$
            \item Challenger sends $pk$ to the adversary
            \item The adversary sends two messages $m_0, m_1$ to the challenger
            \item The challenger encrypts $m_1$ using $pk$ and sends it to the adversary
        \end{enumerate}

        \item \textbf{World 1}: $m_1$ is encrypted using $\setup$
        \begin{enumerate}
            \item Challenger creates a public key $pk$ and a secret key $sk$ using $\setup$
            \item Challenger sends $pk$ to the adversary
            \item The adversary sends two messages $m_0, m_1$ to the challenger
            \item The challenger encrypts $m_1$ using $pk$ and sends it to the adversary
        \end{enumerate}
    \end{itemize}

    \textbf{World 0 and Hybrid 0}\\
    computational\\
    \textbf{Hybrid 0 and Hybrid 1}\\
    statistical \\
    \textbf{Hybrid 1 and World 1}\\
    computational\\
    \end{proof}
\end{solution}
